<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<title>game</title>
<link rel="stylesheet" href="css/myAnimation.css">
<link rel="stylesheet" href="css/game.css">
<link rel="stylesheet" href="css/messagebox.css">
<script type="text/javascript" src="js/messagebox.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script type="text/javascript" src="js/game.js"></script>

<link rel="stylesheet" href="css/shop.css">
<link rel="stylesheet" href="css/animation.css">
<!--[if IE 7]><link rel="stylesheet" href="css/shop-ie7.css"><![endif]-->
</head>

<body class="day">
<div id="header">
  <i class="icon-award"></i>
</div>
<div id="main">
	<div id="menu1" class="oShow">
      <div class="start" id="start"> <i class="icon-play"></i> </div>
      <ul class="btnbox">
        <li id="openset"> <i class="icon-cog"></i> </li>
        <li id="top"> <i class="icon-chart-bar"></i> </li>
        <li id="about"> <i class="icon-star"></i> </li>
      </ul>
      <div class="start" id="random" style="background:#34c69f;"> <i class="icon-shuffle"></i> </div>
  </div>
  <ul id="menu2"  style="display:none">
  	<li class=""> <i class="icon-award"></i>多人游戏 </li>
    <li class=""> <i class="icon-login"></i>加入游戏 </li>
    <li class=""> <i class="icon-gamepad"></i>单机游戏 </li>
  </ul>
  <div id="returnMenu" class="bShow" style="display:none"><i class="icon-home"></i></div>
</div>
<div id="game">
  <div id="stop"><i class="icon-pause"></i></div>
  <div class="gamebody" id="gamebody"> <i></i> </div>
  <ul class="chosen-list">
    <li id="option1"> </li>
    <li id="option2"> </li>
    <li id="option3"> </li>
  </ul>
  <ul class="chosen-list">
    <li id="op-option1"> </li>
    <li id="op-option2"> </li>
    <li id="op-option3"> </li>
  </ul>
  <div id="optcover"></div>
</div>
<div id="endgame">
  <div class="end">
    <div id="tip">最终分数</div>
    <ul class="endlist">
      <li id="home1" style="display:none"><i class="icon-home"></i></li>
      <li id="replay" style="display:inline-block"><i class="icon-cw"></i></li>
    </ul>
  </div>
</div>
<div id="toplist" class="oShow">
  <p style="font-size:20px;text-align:center;color:#fff;padding-bottom:20px">排行榜<span style="font-size:.6em">(目前还没有数据库)</span></p>
  <ul>
    <li><span>1</span> <span>Mr.Wang</span> <span>111</span> <span>2015-3-11 15:00:00</span></li>
    <li><span>2</span> <span>小明	</span> <span>111</span> <span>2015-3-11 15:00:00</span></li>
    <li><span>3</span> <span>小红</span> <span>111</span> <span>2015-3-11 15:00:00</span></li>
    <li><span>4</span> <span>小刚</span> <span>111</span> <span>2015-3-11 15:00:00</span></li>
    <li><span>5</span> <span>小明的爸小花</span> <span>111</span> <span>2015-3-11 15:00:00</span></li>
  </ul>
</div>
<div id="aboutbox" class="oShow">
	<div class="content">
    	<div style="text-align:center;font-size:2em"><i class="icon-trophy"></i></div>
        <p>关于游戏：</p>
        <p style="text-align:center">开放源码，见托管项目<br><a href="#" ><i class="icon-github-circled"></i>Github</a></p>
    </div>
</div>
<div id="cover" class="oShow"> </div>
<div id="set">
  <ul class="setlist">
    <li id="home" style="display:none"><i class="icon-home"></i></li>
    <li id="day"><i class="icon-moon-inv"></i></li>
    <li id="music"><i class="icon-volume-off"></i></li>
  </ul>
</div>

<script>
var gm=new game(); 
if(getQueryString("room") != null){
	gm.room = getQueryString("room");
	gm.send(1);
}

var d = document;
function gd(id){return d.getElementById(id)||null;};
function s(e,c){e.style.display="block";e.className = c;c = e.className;e.className = c.replace(/Hide/, "Show");}
function h(e,time){var c = e.className;e.className = c.replace(/Show/, "Hide");setTimeout(function(){e.style.display = "none"},time||600)};
function sul(ul,c,t){
	if(typeof c == 'number'){t=c;c=null;}
	ul.style.display = "block";
	ul.style.height = ul.clientHeight + "px";
	var lst = ul.getElementsByTagName("li");
	for(var i=0;i<lst.length;i++)lst[i].style.display = "none";
	var i = 0;
	lst[i].style.display = "block";
	lst[i].className = c||"oShow";
	var timer = setInterval(function(){
		i++;
		if(i>=lst.length) clearInterval(timer);
		else{
			lst[i].style.display = "block";
			lst[i].className = c||"oShow";
		}
	},t||300);
}
function aH(){var c=this.className;if(c.match(/Hide/)!=null){this.style.display = "none";this.className=c.replace(/Hide/, "Show")}}
var height = d.documentElement.clientHeight;
var width = d.documentElement.clientWidth;
var cover = gd('cover'),setting = gd('set'),toplist = gd('toplist'),menu = gd('main'),about = gd("aboutbox")
,menu1 = gd("menu1"),menu2 = gd("menu2"),toHome = gd("returnMenu");
cover.addEventListener("webkitAnimationEnd",aH);
setting.addEventListener("webkitAnimationEnd",aH);
menu.addEventListener("webkitAnimationEnd",aH);
about.addEventListener("webkitAnimationEnd",aH);
cover.style.height = height + 'px';
menu.style.marginTop = (height - 128) / 2 -106 +"px";
toplist.style.marginTop = (height - 375) / 2 + 'px';

cover.onclick = function(){
	h(setting);h(cover);h(about);h(toplist);
	var li = toplist.getElementsByTagName("li");
	for(var i=0;i<li.length;i++)li[i].style.display = "none";
	d.getElementById('stop').getElementsByTagName('i')[0].className = "icon-pause";
}
toHome.onclick = function(){
	h(menu2);h(this);
	setTimeout(function(){
		s(menu1,"oShow");
	},600);
}
gd('day').onclick = function(){
		var body = document.body;
		if(body.className == 'day') {
			body.className="night";
			this.getElementsByTagName('i')[0].className = 'icon-sun';
		}
		else{
			 body.className = 'day';
			 this.getElementsByTagName('i')[0].className = 'icon-moon-inv';
		}
		//document.getElementById('set').style.display = "none";
}
gd('music').onclick = function(){
		var i = this.getElementsByTagName('i')[0];
		(i.className == 'icon-volume-off') ? i.className = 'icon-volume-down' : i.className = 'icon-volume-off';
}
gd('openset').onclick = function(){
	if(setting.style.display == "block") h(setting);
	else 	{
		s(setting,"bShow");
		s(cover,"oShow");
	}
}
gd("about").onclick = function(){
	if(about.style.display == "block") h(about);
	else 	{
		s(about,"oShow");
		s(cover,"oShow");
	}
}

gd('start').onclick = function(){
	gd('home1').style.display="inline-block";
	gd('home').style.display="inline-block";
	gd('replay').style.display="inline-block";
	//gm.send(0);
	h(menu1);
	setTimeout(function(){
		sul(menu2,"lShow",200);s(menu2,"oShow");
		s(toHome,"bShow");
	},600);
}
gd('stop').onclick = function(){
	if(setting.style.display == "block") h(setting);
	else 	{
		s(setting,"bShow");
		s(cover,"oShow");
	}
}

d.getElementById('home').onclick = function(){
			d.getElementById('main').style.display="block";
			d.getElementById('game').style.display="none";
			d.getElementById('replay').style.display="none";
			d.getElementById('endgame').style.display="none";
			this.style.display="none";
			cover.click();
}	
d.getElementById('home1').onclick = function(){
			d.getElementById('main').style.display="block";
			d.getElementById('game').style.display="none";
			d.getElementById('replay').style.display="none";
			d.getElementById('endgame').style.display="none";
			d.getElementById('home').style.display="none";
			this.style.display="none";
			cover.click();
}	
gd('replay').onclick = function(){
	gd('endgame').style.display="none";
	//aaa.init();
}
gd("top").onclick = function () {
	s(cover,"oShow");s(toplist,"oShow");sul(toplist.getElementsByTagName("ul")[0],"lShow");
}

	function getQueryString(name) {
		var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
		var r = window.location.search.substr(1).match(reg);
		if (r != null)
			return unescape(r[2]);
		return null;
	}
</script>
</body>
</html>
